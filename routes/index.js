var express = require('express');
var router = express.Router();
var BSON = require('bson');
var request = require('request');

var config = require('../config/config');
var aotuConfig = config.wx_config.aotu;
var dbHandler = require('../lib/dbHandler');
var viewHandler = require('../lib/viewHandler');
var course = require('../lib/course');

var wxConfig = require('../config/wxConfig');
var cryptoMO = require('crypto'); // MD5算法
var parseString = require('xml2js').parseString; // xml转js对象
var key = wxConfig.Mch_key;
var xlsx = require('node-xlsx').default;
var fs = require('fs');

var XMLJS = require('xml2js');
//解析，将xml解析为json
var parser = new XMLJS.Parser();
//重组，将json重组为xml
var builder = new XMLJS.Builder();

var util = require('../util/util');

var cache = {
    ticket: null,
    time: 0
}

router.get('/scoreForXlsx', function (req, res) {
    dbHandler.createScoreXlsx(req, res);
})

router.get('/modify', function (req, res) {
    if (req.query.terribleterribledamaged) {
        console.log(__dirname)
        const workSheetsFromFile = xlsx.parse(`${__dirname}/../public/team.xlsx`);
        let users = [];
        if (workSheetsFromFile && workSheetsFromFile[0] && workSheetsFromFile[0].data) {
            let user = workSheetsFromFile[0].data;
            users = user.map((child) => {
                if (child && child[0] && child[0] !== '邮箱') {
                    return {
                        email: child[0].trim(),
                        team: child[3].trim()
                    };
                }
            }).filter((cld) => { return cld != null })
        }
        dbHandler.updateUserEmail(req, res, users)
        // res.send({status: 'success', users:users})
    }
    else {
        res.send('failed')
    }
})
router.get('/load', function (req, res) {
    if (req.query.terribleterribledamaged) {
        console.log(__dirname)
        const workSheetsFromFile = xlsx.parse(`${__dirname}/../public/user.xlsx`);
        let users = [];
        if (workSheetsFromFile && workSheetsFromFile[1] && workSheetsFromFile[1].data) {
            let user = workSheetsFromFile[1].data;
            users = user.map((child) => {
                if (child && child[0] && child[0] !== 'Email Address') {
                    return child[0];
                }
            }).filter((cld) => { return cld != null })
        }
        dbHandler.createUsersFromXlsx(req, res, users)
        // res.send({status: 'success', users:users})
    }
    else {
        res.send('failed')
    }
})
// const language = require('../lib/resource')
router.get('/temp', function (req, res) {
    var data = JSON.parse(`[["2017\/10\/17 03:31","2017\/10\/17 07:02","2017\/10\/17 08:01","2017\/10\/17 08:14","2017\/10\/17 08:17","2017\/10\/17 08:34","2017\/10\/17 08:35","2017\/10\/17 09:25","2017\/10\/17 12:33","2017\/10\/18 03:09","2017\/10\/18 06:54","2017\/10\/18 07:07","2017\/10\/18 07:18","2017\/10\/18 08:27","2017\/10\/18 08:31","2017\/10\/18 08:41","2017\/10\/18 08:42","2017\/10\/18 09:06","2017\/10\/19 02:44","2017\/10\/19 02:45","2017\/10\/19 03:04","2017\/10\/19 03:04","2017\/10\/19 03:05","2017\/10\/19 03:06","2017\/10\/19 03:07","2017\/10\/19 03:18","2017\/10\/19 03:19","2017\/10\/19 03:53","2017\/10\/19 04:03","2017\/10\/19 04:06","2017\/10\/19 04:07","2017\/10\/19 04:12","2017\/10\/19 04:25","2017\/10\/19 04:50","2017\/10\/19 04:57","2017\/10\/19 05:05","2017\/10\/19 05:09","2017\/10\/19 05:11","2017\/10\/19 05:57","2017\/10\/19 07:44","2017\/10\/19 08:12","2017\/10\/19 08:24","2017\/10\/19 08:29","2017\/10\/19 08:33","2017\/10\/19 08:34","2017\/10\/19 08:45","2017\/10\/19 08:47","2017\/10\/19 08:49","2017\/10\/19 09:00","2017\/10\/19 09:06","2017\/10\/19 09:15","2017\/10\/19 09:16","2017\/10\/19 10:40","2017\/10\/19 10:44","2017\/10\/19 10:59","2017\/10\/19 11:14","2017\/10\/19 12:10","2017\/10\/20 01:16","2017\/10\/20 01:47","2017\/10\/20 01:51","2017\/10\/20 01:52","2017\/10\/20 02:20","2017\/10\/20 02:24","2017\/10\/20 02:29","2017\/10\/20 02:31","2017\/10\/20 02:47","2017\/10\/20 05:21","2017\/10\/20 05:26","2017\/10\/20 05:32","2017\/10\/20 05:37","2017\/10\/20 05:39","2017\/10\/20 06:05","2017\/10\/20 06:11","2017\/10\/20 06:45","2017\/10\/20 06:59","2017\/10\/20 07:01","2017\/10\/20 07:06","2017\/10\/20 07:21","2017\/10\/20 07:46","2017\/10\/20 07:52","2017\/10\/20 07:53","2017\/10\/20 07:57","2017\/10\/20 07:58","2017\/10\/20 08:07","2017\/10\/20 09:15","2017\/10\/20 09:32","2017\/10\/20 09:38","2017\/10\/20 10:02","2017\/10\/20 10:06","2017\/10\/20 10:50","2017\/10\/20 11:03","2017\/10\/20 11:14","2017\/10\/20 11:19","2017\/10\/20 11:41","2017\/10\/20 11:54","2017\/10\/20 11:57","2017\/10\/23 01:24","2017\/10\/23 01:47","2017\/10\/23 02:05","2017\/10\/23 02:10","2017\/10\/23 02:25","2017\/10\/23 02:31","2017\/10\/23 02:37","2017\/10\/23 02:40","2017\/10\/23 02:42","2017\/10\/23 03:28","2017\/10\/23 05:23","2017\/10\/23 05:25","2017\/10\/23 05:27","2017\/10\/23 05:37","2017\/10\/23 05:58","2017\/10\/23 06:01","2017\/10\/23 08:23","2017\/10\/23 08:36","2017\/10\/23 08:47","2017\/10\/23 08:54","2017\/10\/23 09:07","2017\/10\/23 09:21","2017\/10\/23 09:23","2017\/10\/23 09:27","2017\/10\/23 09:47","2017\/10\/23 09:49","2017\/10\/23 09:53","2017\/10\/23 10:45","2017\/10\/23 10:46","2017\/10\/23 10:47","2017\/10\/23 11:12","2017\/10\/24 04:21","2017\/10\/24 04:29","2017\/10\/24 04:38","2017\/10\/24 04:39","2017\/10\/24 05:16","2017\/10\/24 05:22","2017\/10\/24 05:23","2017\/10\/24 05:24","2017\/10\/24 05:31","2017\/10\/24 05:40","2017\/10\/24 06:22","2017\/10\/24 06:26","2017\/10\/24 06:33","2017\/10\/24 06:59","2017\/10\/24 07:00","2017\/10\/24 07:15","2017\/10\/24 07:32","2017\/10\/24 07:35","2017\/10\/24 07:39","2017\/10\/24 07:46","2017\/10\/24 07:57","2017\/10\/24 07:58","2017\/10\/24 07:59","2017\/10\/24 08:02","2017\/10\/24 08:03","2017\/10\/24 08:08","2017\/10\/24 08:09","2017\/10\/24 08:10","2017\/10\/24 08:12","2017\/10\/24 08:50","2017\/10\/24 08:52","2017\/10\/24 08:56","2017\/10\/24 09:05","2017\/10\/24 09:06","2017\/10\/24 09:07","2017\/10\/24 09:08","2017\/10\/24 09:10","2017\/10\/24 09:12","2017\/10\/24 09:18","2017\/10\/24 10:27","2017\/10\/24 11:34","2017\/10\/24 11:38","2017\/10\/24 12:00","2017\/10\/24 12:05","2017\/10\/24 13:28","2017\/10\/24 13:33","2017\/10\/24 13:35","2017\/10\/24 13:46","2017\/10\/24 13:56","2017\/10\/24 13:57","2017\/10\/25 01:16","2017\/10\/25 01:17","2017\/10\/25 01:20","2017\/10\/25 01:25","2017\/10\/25 01:28","2017\/10\/25 01:31","2017\/10\/25 01:35","2017\/10\/25 01:42","2017\/10\/25 01:44","2017\/10\/25 01:46","2017\/10\/25 01:47","2017\/10\/25 02:08","2017\/10\/25 02:20","2017\/10\/25 02:29","2017\/10\/25 05:06","2017\/10\/25 05:18","2017\/10\/25 05:19","2017\/10\/25 05:22","2017\/10\/25 05:23","2017\/10\/25 05:27","2017\/10\/25 06:22","2017\/10\/25 08:17","2017\/10\/25 08:30","2017\/10\/25 08:38","2017\/10\/25 09:00","2017\/10\/25 09:05","2017\/10\/25 09:09","2017\/10\/25 09:17","2017\/10\/25 09:24","2017\/10\/25 09:28","2017\/10\/25 10:00","2017\/10\/25 10:01","2017\/10\/25 10:06","2017\/10\/25 10:07","2017\/10\/25 10:24","2017\/10\/25 10:31","2017\/10\/25 10:33","2017\/10\/25 10:34","2017\/10\/25 10:36","2017\/10\/25 11:21","2017\/10\/25 11:25","2017\/10\/25 11:53","2017\/10\/25 12:06","2017\/10\/25 12:40","2017\/10\/25 12:41","2017\/10\/25 12:42","2017\/10\/25 12:43","2017\/10\/25 12:59","2017\/10\/25 13:26","2017\/10\/25 13:28","2017\/10\/25 13:40","2017\/10\/25 13:55","2017\/10\/25 13:59","2017\/10\/25 14:06","2017\/10\/25 14:11","2017\/10\/25 14:12","2017\/10\/25 14:15","2017\/10\/25 14:20","2017\/10\/25 14:25","2017\/10\/25 14:28","2017\/10\/25 14:41","2017\/10\/25 14:48","2017\/10\/25 14:49","2017\/10\/25 14:50","2017\/10\/25 14:54","2017\/10\/25 14:58","2017\/10\/25 15:04","2017\/10\/25 15:17","2017\/10\/25 15:18","2017\/10\/25 15:55","2017\/10\/25 15:57","2017\/10\/25 16:09","2017\/10\/25 16:12","2017\/10\/25 16:19","2017\/10\/25 16:33","2017\/10\/25 16:51","2017\/10\/25 16:59","2017\/10\/25 17:07","2017\/10\/25 17:13","2017\/10\/25 17:51","2017\/10\/25 18:07","2017\/10\/25 18:14","2017\/10\/25 20:50","2017\/10\/25 20:53","2017\/10\/25 21:05","2017\/10\/25 21:06","2017\/10\/25 21:07","2017\/10\/25 21:08","2017\/10\/25 21:09","2017\/10\/25 22:28","2017\/10\/25 22:50","2017\/10\/26 00:15","2017\/10\/26 00:51","2017\/10\/26 01:20","2017\/10\/26 01:52","2017\/10\/26 02:01","2017\/10\/26 06:05","2017\/10\/26 07:15","2017\/10\/26 07:20","2017\/10\/26 07:21","2017\/10\/26 07:22","2017\/10\/26 08:22","2017\/10\/26 08:43","2017\/10\/26 09:17","2017\/10\/26 09:32","2017\/10\/26 09:42","2017\/10\/26 11:50","2017\/10\/27 02:49","2017\/10\/27 07:12","2017\/10\/27 07:55","2017\/10\/27 08:07","2017\/10\/30 08:07","2017\/10\/30 08:10","2017\/10\/30 12:57","2017\/10\/30 13:17","2017\/10\/30 13:24","2017\/10\/30 16:29","2017\/10\/31 09:04","2017\/10\/31 11:25","2017\/10\/31 13:00","2017\/10\/31 13:04","2017\/11\/01 06:09","2017\/11\/01 06:10","2017\/11\/01 06:49","2017\/11\/01 08:25","2017\/11\/01 09:11","2017\/11\/01 09:21","2017\/11\/01 09:32","2017\/11\/03 09:59","2017\/11\/03 11:20","2017\/11\/03 13:05","2017\/11\/06 08:27","2017\/11\/06 08:54","2017\/11\/06 09:00","2017\/11\/06 09:16","2017\/11\/08 10:38","2017\/11\/08 12:16","2017\/11\/09 05:34","2017\/11\/09 08:58","2017\/11\/09 09:15","2017\/11\/10 07:44","2017\/11\/10 08:00","2017\/11\/10 08:04","2017\/11\/10 12:12","2017\/11\/10 12:13","2017\/11\/10 13:38","2017\/11\/13 08:59","2017\/11\/13 09:57","2017\/11\/13 11:47","2017\/11\/14 07:18","2017\/11\/14 07:34","2017\/11\/14 07:55","2017\/11\/15 07:38","2017\/11\/15 09:29","2017\/11\/15 09:38","2017\/11\/15 09:44","2017\/11\/15 10:05","2017\/11\/16 07:21","2017\/11\/16 07:35","2017\/11\/16 13:51","2017\/11\/16 14:41","2017\/11\/16 15:34","2017\/11\/17 01:30","2017\/11\/17 02:03","2017\/11\/17 02:32","2017\/11\/17 08:02","2017\/11\/17 08:48","2017\/11\/17 11:01","2017\/11\/17 11:09","2017\/11\/20 06:49","2017\/11\/20 07:14","2017\/11\/20 07:17","2017\/11\/21 07:37","2017\/11\/21 11:21","2017\/11\/21 14:24","2017\/11\/22 09:51","2017\/11\/22 12:57","2017\/11\/23 08:25","2017\/11\/23 09:23","2017\/11\/23 09:36","2017\/11\/24 08:17","2017\/11\/24 14:17","2017\/11\/27 08:28","2017\/11\/27 13:00","2017\/11\/27 14:44","2017\/11\/28 07:20","2017\/11\/28 08:46","2017\/11\/28 11:20","2017\/11\/28 12:50","2017\/11\/28 15:53","2017\/11\/29 07:12","2017\/11\/29 07:14","2017\/11\/29 07:34","2017\/11\/30 08:37","2017\/11\/30 12:06","2017\/11\/30 14:06","2017\/11\/30 14:51","2017\/12\/01 02:14","2017\/12\/01 07:52","2017\/12\/01 07:58","2017\/12\/01 08:35","2017\/12\/01 08:43","2017\/12\/01 09:25","2017\/12\/01 09:28","2017\/12\/01 11:45","2017\/12\/04 07:10","2017\/12\/04 07:12","2017\/12\/04 11:21","2017\/12\/05 08:00","2017\/12\/05 08:30","2017\/12\/07 08:53","2017\/12\/07 10:24","2017\/12\/07 10:59","2017\/12\/07 11:39","2017\/12\/07 11:57","2017\/12\/07 12:00","2017\/12\/08 04:50","2017\/12\/08 06:08","2017\/12\/11 08:21","2017\/12\/11 08:22","2017\/12\/11 10:26","2017\/12\/11 11:45","2017\/12\/11 14:40","2017\/12\/12 02:06","2017\/12\/12 09:30","2017\/12\/12 09:31","2017\/12\/12 09:38","2017\/12\/13 08:55","2017\/12\/13 10:12","2017\/12\/13 13:21","2017\/12\/13 13:25","2017\/12\/14 10:27","2017\/12\/14 10:31","2017\/12\/15 17:01","2017\/12\/15 17:05","2017\/12\/15 19:53","2017\/12\/15 21:00","2017\/12\/18 14:22","2017\/12\/20 16:03","2017\/12\/20 17:00","2017\/12\/20 20:01","2017\/12\/21 20:33","2017\/12\/27 16:39","2017\/12\/29 13:29","2017\/12\/29 23:57","2018\/01\/02 18:02","2018\/01\/05 10:14","2018\/01\/05 13:56","2018\/01\/08 11:01","2018\/01\/09 01:37","2018\/01\/09 01:47","2018\/01\/09 06:53","2018\/01\/11 07:38","2018\/01\/11 07:42","2018\/01\/11 07:43","2018\/01\/11 08:33","2018\/01\/11 19:54","2018\/01\/12 09:16","2018\/01\/12 09:16","2018\/01\/12 16:55","2018\/01\/17 08:20","2018\/01\/17 22:05","2018\/01\/18 11:23","2018\/01\/18 20:37","2018\/01\/18 22:21","2018\/01\/19 09:30","2018\/01\/19 09:39","2018\/01\/19 11:35","2018\/01\/19 12:43","2018\/01\/19 22:00","2018\/01\/22 08:37","2018\/01\/23 07:28","2018\/01\/23 08:38","2018\/01\/23 14:37","2018\/01\/24 08:43","2018\/01\/24 11:44","2018\/01\/24 19:18","2018\/01\/24 19:54","2018\/01\/25 07:59","2018\/01\/25 08:26","2018\/01\/25 09:02","2018\/01\/25 15:36","2018\/01\/25 16:21","2018\/01\/25 17:15","2018\/01\/25 17:51","2018\/01\/26 16:22","2018\/01\/30 12:18","2018\/01\/30 16:04","2018\/01\/30 16:16","2018\/01\/30 16:59","2018\/01\/30 17:48","2018\/01\/31 16:41","2018\/01\/31 16:52","2018\/01\/31 17:39","2018\/02\/01 03:17","2018\/02\/01 03:23","2018\/02\/01 08:16","2018\/02\/01 16:28","2018\/02\/01 21:27","2018\/02\/02 11:02","2018\/02\/05 08:45","2018\/02\/05 09:34","2018\/02\/06 04:56","2018\/02\/06 05:11","2018\/02\/06 05:39","2018\/02\/06 06:14","2018\/02\/07 07:19","2018\/02\/07 07:38","2018\/02\/09 05:40","2018\/02\/09 06:01","2018\/02\/09 06:39","2018\/02\/12 03:58","2018\/02\/14 02:57","2018\/02\/14 03:58","2018\/02\/23 08:06","2018\/02\/23 08:34","2018\/02\/26 07:36","2018\/02\/27 07:49","2018\/02\/27 08:13","2018\/02\/27 16:36","2018\/02\/28 08:56","2018\/02\/28 09:58","2018\/02\/28 11:47","2018\/02\/28 12:08","2018\/03\/01 02:11","2018\/03\/02 05:56","2018\/03\/02 06:38","2018\/03\/05 08:10","2018\/03\/06 11:13","2018\/03\/08 12:48","2018\/03\/08 14:38","2018\/03\/09 12:02","2018\/03\/09 13:32","2018\/03\/09 14:40","2018\/03\/09 14:52","2018\/03\/12 12:39","2018\/03\/14 08:56","2018\/03\/14 10:42","2018\/03\/16 07:37","2018\/03\/19 09:07","2018\/03\/19 09:38","2018\/03\/20 07:19","2018\/03\/20 09:11","2018\/03\/21 09:34","2018\/03\/21 11:47","2018\/03\/21 12:43","2018\/03\/22 08:04","2018\/03\/22 09:27","2018\/03\/22 09:56","2018\/03\/22 12:08","2018\/03\/23 08:01","2018\/03\/23 08:52","2018\/03\/23 10:32","2018\/03\/23 12:00","2018\/03\/23 12:19","2018\/03\/26 06:53","2018\/03\/27 07:24","2018\/03\/27 07:36","2018\/03\/27 07:59","2018\/03\/28 06:03","2018\/03\/28 06:44","2018\/03\/28 07:16","2018\/03\/29 07:04","2018\/03\/29 09:20","2018\/03\/29 10:46","2018\/03\/29 14:47","2018\/03\/30 06:17","2018\/04\/02 15:05","2018\/04\/02 15:08","2018\/04\/02 15:21","2018\/04\/04 07:10","2018\/04\/04 07:49","2018\/04\/04 08:03","2018\/04\/05 06:36","2018\/04\/05 08:53","2018\/04\/05 11:28","2018\/04\/05 15:23","2018\/04\/06 09:15","2018\/04\/06 13:34","2018\/04\/09 06:20","2018\/04\/10 07:58","2018\/04\/10 11:50","2018\/04\/10 15:25","2018\/04\/11 06:44","2018\/04\/11 09:01","2018\/04\/12 09:01","2018\/04\/13 06:25","2018\/04\/16 06:26","2018\/04\/16 08:06","2018\/04\/17 08:36","2018\/04\/18 07:02","2018\/04\/18 08:39","2018\/04\/19 08:33","2018\/04\/20 08:32","2018\/04\/20 09:09","2018\/04\/23 07:27","2018\/04\/23 08:42","2018\/04\/24 08:56","2018\/04\/24 12:36","2018\/04\/25 16:59","2018\/04\/26 14:21","2018\/04\/26 15:37","2018\/04\/27 08:32","2018\/04\/30 06:47","2018\/04\/30 08:59","2018\/05\/01 03:21","2018\/05\/02 06:14","2018\/05\/02 08:30","2018\/05\/03 09:12","2018\/05\/03 10:04","2018\/05\/04 08:58","2018\/05\/08 09:48","2018\/05\/08 13:17","2018\/05\/09 08:58","2018\/05\/09 11:02","2018\/05\/09 11:29","2018\/05\/10 07:51","2018\/05\/10 08:18","2018\/05\/10 08:36","2018\/05\/11 07:16","2018\/05\/14 07:14","2018\/05\/14 07:47","2018\/05\/16 07:04","2018\/05\/16 12:17","2018\/05\/16 13:23","2018\/05\/17 06:49","2018\/05\/17 07:15","2018\/05\/17 07:59","2018\/05\/18 07:01","2018\/05\/18 07:03","2018\/05\/18 09:42","2018\/05\/21 10:04","2018\/05\/21 12:00","2018\/05\/22 07:28","2018\/05\/22 07:41","2018\/05\/22 08:30","2018\/05\/22 09:28","2018\/05\/23 07:04","2018\/05\/24 06:20","2018\/05\/24 06:31","2018\/05\/24 06:45","2018\/05\/25 07:03","2018\/05\/25 07:13","2018\/05\/28 06:01","2018\/05\/29 06:07","2018\/05\/29 06:20","2018\/05\/30 05:53","2018\/05\/30 06:10","2018\/05\/30 06:58","2018\/05\/31 05:42","2018\/05\/31 06:34","2018\/06\/04 07:03","2018\/06\/05 07:51","2018\/06\/05 11:54","2018\/06\/08 06:14","2018\/06\/13 08:08","2018\/06\/13 09:36","2018\/06\/13 15:57","2018\/06\/14 08:36","2018\/06\/15 07:12","2018\/06\/18 12:44","2018\/06\/18 18:11","2018\/06\/19 07:05","2018\/06\/19 07:26","2018\/06\/20 06:39","2018\/06\/22 05:36","2018\/06\/22 08:45","2018\/06\/25 13:45","2018\/06\/25 14:48","2018\/06\/26 08:04","2018\/06\/26 09:11","2018\/06\/27 07:09","2018\/06\/27 07:47","2018\/06\/28 05:38","2018\/07\/02 07:03","2018\/07\/02 07:43","2018\/07\/02 08:46","2018\/07\/03 06:10","2018\/07\/04 08:09","2018\/07\/05 05:49","2018\/07\/05 07:41","2018\/07\/05 07:43","2018\/07\/05 07:45","2018\/07\/05 07:46","2018\/07\/05 07:47","2018\/07\/05 07:48","2018\/07\/05 07:49","2018\/07\/06 12:36","2018\/07\/09 07:27","2018\/07\/09 08:22","2018\/07\/09 10:25","2018\/07\/10 07:04","2018\/07\/10 07:58","2018\/07\/11 06:27","2018\/07\/11 07:04","2018\/07\/11 12:40","2018\/07\/16 11:57","2018\/07\/17 08:32","2018\/07\/17 09:27","2018\/07\/17 11:18","2018\/07\/18 08:26","2018\/07\/18 08:31","2018\/07\/18 08:35","2018\/07\/19 08:36","2018\/07\/20 07:18","2018\/07\/23 14:52","2018\/07\/24 07:41","2018\/07\/26 14:27","2018\/07\/26 15:51","2018\/07\/27 06:37","2018\/07\/27 07:19","2018\/07\/27 12:59","2018\/07\/31 06:41","2018\/07\/31 08:07","2018\/07\/31 10:41","2018\/08\/02 07:21","2018\/08\/07 18:51","2018\/08\/08 07:29","2018\/08\/08 08:18","2018\/08\/09 05:07","2018\/08\/14 05:49","2018\/08\/14 06:54","2018\/08\/15 07:19","2018\/08\/17 09:56","2018\/08\/20 07:38","2018\/08\/20 11:08","2018\/08\/21 07:58","2018\/08\/21 14:00","2018\/08\/22 08:08","2018\/08\/24 10:24","2018\/08\/28 07:13","2018\/08\/28 07:53"],[0,40.5,87.32,126.55,81.97,75.28,88.65,108,117.1,131.69,147.19,137.25,152.25,167.61,194.91,192.42,196.09,217.32,219.09,220.86,221.17,223.03,224.93,227.14,229.09,231.08,233.39,234.94,233.13,234.94,236.71,234.9,233.45,235.33,237.14,235.69,234.2,232.68,230.91,149.83,231.65,223.95,246.44,292.17,284.62,299.87,292.48,306.97,295.32,294.33,303.11,301.78,281.26,279.14,290,299.82,293.93,280.31,295.17,296.32,295,295.26,300.03,297.91,293.32,288.82,286.88,288.12,297.93,301.2,303.14,298.72,311.87,260.36,373.55,326.24,372.53,329.27,532.52,471.32,470.35,467.79,465.67,536.3,531.8,519.89,508.77,489.37,510.27,496.59,480.35,475.85,486.97,482.19,492.88,498.01,497.66,498.73,498.29,497.83,498.34,497.9,497.89,497.85,497.78,497.33,497.09,497.43,497.75,498.13,497.69,498.75,501.53,502.76,503.95,503.51,503.07,463.05,462.98,462.53,462.45,462.01,461.54,461.68,461.76,461.3,461.23,451.71,451.6,451.95,452.66,443.66,440.49,440.3,439.93,440.55,440.23,441.3,441.55,441.7,441.26,440.81,440.37,441.31,441.27,441.23,441.42,441.35,441.44,441.47,441.26,440.7,441.09,440.69,440.94,441.18,441.71,441.24,440.79,440.35,439.91,439.92,434.11,437.1,426.72,455.73,446.76,437.09,458.37,479.63,501.74,500.26,497.19,493.99,500.14,501.19,498.05,502.39,500.28,491.31,490.96,482.18,491.14,482.35,473.39,471.98,470.75,473.56,491.13,500.79,502.9,494.12,501.15,500.45,494.66,498.35,489.56,480.6,471.29,458.12,553.79,631.07,622.31,649.83,670.86,692.58,727.6,718.15,698.89,722.71,713.77,705.02,696.09,736.39,767.4,792.28,806.38,801.65,813.22,808.04,810.58,810.14,808.83,806.46,806.02,809.25,808.81,808.36,807.92,807.49,807.04,806.6,806.11,805.62,807.84,807.39,808.46,808.02,807.57,807.09,806.65,806.2,805.76,806.81,807.89,807.16,806.72,806.27,805.8,805.36,806.42,807.79,807.26,806.8,806.29,807.75,807.29,808.45,806.91,806.47,806.02,805.55,804.67,803.92,802.91,801.52,801.06,800.6,801.99,801.36,802.13,803.27,814.9,803.22,830.67,830.85,831.04,831.26,811.48,885.11,944.87,923.5,983.69,1043.47,1103.01,1096.01,1137.78,1161.2,1095.25,1033.77,973.04,993.31,875.68,854.53,915.9,895.21,993.78,1136.13,1052.99,976.88,1050.68,1070,1044.9,1129.85,1220.11,1320.01,1238.54,1319.57,1244.77,1217.29,1293.36,1388.06,1466.94,1524.55,1609.65,1690.23,1558.33,1585.28,1501.82,1578.42,1692.46,1592.24,1678.92,1576.39,1500.99,1419.55,1499.29,1574.49,1633.14,1606.91,1581.63,1556.34,1747.06,1674.73,1565.05,1592.07,1499.16,1399.23,1281.22,1387.63,1469.2,1567.4,1539.67,1513.04,1665.48,1748.63,1640.49,1748.11,1810.75,1703.56,1648.64,1768.85,1876.44,2010.77,1954.68,2063.05,2052.27,1997.89,2081.9,2190.91,2300.08,2167.26,2221.72,2102.52,2048.62,2156.95,2300.95,2412.94,2498.53,2383.35,2489.08,2653.05,2536.48,2439.49,2439.49,2520.21,2439.9,2481.12,2380.64,2262.08,2160.39,2240.86,2156.68,2237.73,2457.89,2379.36,2537.99,2459.5,2334.52,2293.91,2373.15,2451.19,2568.26,2647.46,2726.24,2590.03,2535.7,2496.51,2543.85,2504.67,2581.35,2684.14,2644.2,2748.56,2840.58,2762.21,2683.8,2594.48,2672.51,2754.06,2714.84,2808.18,2888.57,2931.32,3019.68,3063.24,3022.79,2983.51,3065.64,3146.78,3227.33,3305.93,3393.95,3422.67,3493.84,3530.27,3459.08,3331.91,3261.22,3206.12,3136.26,3076.24,3130.67,3202.68,3276.83,3350.98,3423.99,3501.27,3573.85,3646.49,3716.25,3635.25,3701.42,3622.57,3541.97,3504.38,3595.9,3668.8,3741.19,3853.16,3762.65,3687.31,3607.28,3644.55,3566.37,3492.62,3370.59,3407.6,3444.27,3480.95,3407.62,3333.17,3423.44,3349.48,3288.4,3232.51,3172.16,3108.87,3071.35,3161.8,3227.29,3227.29,3227.29,3303.3,3358.08,3413.55,3472.27,3528,3423.11,3385.91,3478.6,3555.01,3613.82,3691.14,3782.85,3745.77,3801.18,3873.84,3951.11,3893.32,3796.76,3857.73,3913.86,3972.49,4028.61,3990.47,4046.7,4008.64,4066.17,4144.58,4201.72,4201.72,4263.67,4326.02,4390.49,4461.36,4391.28,4334.42,4400.71,4488.94,4449.25,4525.19,4605.86,4682.39,4739.07,4827.58,4751.32,4683.77,4560.14,4675.44,4797.78,4693.12,4663.76,4721.69,4668.67,4747.09,4807.28,4768.8,4833.23,4794.35,4753.24,4850.23,4937.43,4997.27,5055.64,4995.73,4938.19,4851.87,4929.5,4892.01,4853.77,4921.3,4981.07,5037.93,5115.16,5175.09,5198.08,5113.24,5013.89,4947.95,4903.86,4863.18,4919.23,4879.01,4936,5002.47,5089.92,5163.67,5273.53,5199.35,5258.4,5316.34,5202.5,5258.66,5346.31,5406.74,5463.95,5519.86,5233.12,5338.19,5296.18,5257.51,5214.88,5277.14,5342.18,5397.25,5357.7,5316.35,5373.78,5576.33,5636.39,5692,5692,5747.36,5823.85,5967.6,5902.61,5846.86,5902.29,5957.6,5888.73,5944.18,6000.72,5912.69,5818.41,5745.61,5771.95,5697.04,5639.67,5694.47,5656.7,5711.21,5674.63,5751.71,5814.68,5778.23,5832.73,5907.7,5871.4,5925.34,6009.56,5972.85,6035.57,6090.7,6204.19,6148.6,6093.08,6008.78,6079.72,6038.03,6094.24,6039.19,5983.76,5945.45,6030.01,5992.9,6058,6113.91,6189.06,6152.28,6258.35,6338.66,6409.88,6373.37,6427.72,6532.81,6477.56,6420.01,6363.53,6418.97,6473.63,6534.64,6480.07,6549.43,6512.57,6475.72,6438.5,6400.93,6455.58,6511.36,6616.51,6560.49,6506.26,6402.28,6456.36,6532.75,6598.56,6624.58,6651.32,6658.56,6662.17,6670.48,6686.02,6699.39,6754.43,6717.14,6774.39,6833.05,6775.44,6691.54,6637.53,6537,6590.92,6553.53,6491.95,6547.12,6641.64,6700.74,6848.99,6778.22,6890.82,6950.61,6913.28,6994.92,6940.21,6862.82,6819.23,6782.85,6837.64,6928.33,6998.34,7034.93,6980.83,7035.04,7113.33,7173.89,7227.97,7191.53,7300.74,7386.26,7458.25,7419.21,7498.77,7462.47,7529.11,7474.41,7408,7463.44,7519.57]]`);

    var jingzhi_data = JSON.parse(`[["2017\/10\/17 03:31","2017\/10\/17 07:02","2017\/10\/17 08:01","2017\/10\/17 08:14","2017\/10\/17 08:17","2017\/10\/17 08:34","2017\/10\/17 08:35","2017\/10\/17 09:25","2017\/10\/17 12:33","2017\/10\/18 03:09","2017\/10\/18 06:54","2017\/10\/18 07:07","2017\/10\/18 07:18","2017\/10\/18 08:27","2017\/10\/18 08:31","2017\/10\/18 08:41","2017\/10\/18 08:42","2017\/10\/18 09:06","2017\/10\/19 02:44","2017\/10\/19 02:45","2017\/10\/19 03:04","2017\/10\/19 03:04","2017\/10\/19 03:05","2017\/10\/19 03:06","2017\/10\/19 03:07","2017\/10\/19 03:18","2017\/10\/19 03:19","2017\/10\/19 03:53","2017\/10\/19 04:03","2017\/10\/19 04:06","2017\/10\/19 04:07","2017\/10\/19 04:12","2017\/10\/19 04:25","2017\/10\/19 04:50","2017\/10\/19 04:57","2017\/10\/19 05:05","2017\/10\/19 05:09","2017\/10\/19 05:11","2017\/10\/19 05:57","2017\/10\/19 07:44","2017\/10\/19 08:12","2017\/10\/19 08:24","2017\/10\/19 08:29","2017\/10\/19 08:33","2017\/10\/19 08:34","2017\/10\/19 08:45","2017\/10\/19 08:47","2017\/10\/19 08:49","2017\/10\/19 09:00","2017\/10\/19 09:06","2017\/10\/19 09:15","2017\/10\/19 09:16","2017\/10\/19 10:40","2017\/10\/19 10:44","2017\/10\/19 10:59","2017\/10\/19 11:14","2017\/10\/19 12:10","2017\/10\/20 01:16","2017\/10\/20 01:47","2017\/10\/20 01:51","2017\/10\/20 01:52","2017\/10\/20 02:20","2017\/10\/20 02:24","2017\/10\/20 02:29","2017\/10\/20 02:31","2017\/10\/20 02:47","2017\/10\/20 05:21","2017\/10\/20 05:26","2017\/10\/20 05:32","2017\/10\/20 05:37","2017\/10\/20 05:39","2017\/10\/20 06:05","2017\/10\/20 06:11","2017\/10\/20 06:45","2017\/10\/20 06:59","2017\/10\/20 07:01","2017\/10\/20 07:06","2017\/10\/20 07:21","2017\/10\/20 07:46","2017\/10\/20 07:52","2017\/10\/20 07:53","2017\/10\/20 07:57","2017\/10\/20 07:58","2017\/10\/20 08:07","2017\/10\/20 09:15","2017\/10\/20 09:32","2017\/10\/20 09:38","2017\/10\/20 10:02","2017\/10\/20 10:06","2017\/10\/20 10:50","2017\/10\/20 11:03","2017\/10\/20 11:14","2017\/10\/20 11:19","2017\/10\/20 11:41","2017\/10\/20 11:54","2017\/10\/20 11:57","2017\/10\/23 01:24","2017\/10\/23 01:47","2017\/10\/23 02:05","2017\/10\/23 02:10","2017\/10\/23 02:25","2017\/10\/23 02:31","2017\/10\/23 02:37","2017\/10\/23 02:40","2017\/10\/23 02:42","2017\/10\/23 03:28","2017\/10\/23 05:23","2017\/10\/23 05:25","2017\/10\/23 05:27","2017\/10\/23 05:37","2017\/10\/23 05:58","2017\/10\/23 06:01","2017\/10\/23 08:23","2017\/10\/23 08:36","2017\/10\/23 08:47","2017\/10\/23 08:54","2017\/10\/23 09:07","2017\/10\/23 09:21","2017\/10\/23 09:23","2017\/10\/23 09:27","2017\/10\/23 09:47","2017\/10\/23 09:49","2017\/10\/23 09:53","2017\/10\/23 10:45","2017\/10\/23 10:46","2017\/10\/23 10:47","2017\/10\/23 11:12","2017\/10\/24 04:21","2017\/10\/24 04:29","2017\/10\/24 04:38","2017\/10\/24 04:39","2017\/10\/24 05:16","2017\/10\/24 05:22","2017\/10\/24 05:23","2017\/10\/24 05:24","2017\/10\/24 05:31","2017\/10\/24 05:40","2017\/10\/24 06:22","2017\/10\/24 06:26","2017\/10\/24 06:33","2017\/10\/24 06:59","2017\/10\/24 07:00","2017\/10\/24 07:15","2017\/10\/24 07:32","2017\/10\/24 07:35","2017\/10\/24 07:39","2017\/10\/24 07:46","2017\/10\/24 07:57","2017\/10\/24 07:58","2017\/10\/24 07:59","2017\/10\/24 08:02","2017\/10\/24 08:03","2017\/10\/24 08:08","2017\/10\/24 08:09","2017\/10\/24 08:10","2017\/10\/24 08:12","2017\/10\/24 08:50","2017\/10\/24 08:52","2017\/10\/24 08:56","2017\/10\/24 09:05","2017\/10\/24 09:06","2017\/10\/24 09:07","2017\/10\/24 09:08","2017\/10\/24 09:10","2017\/10\/24 09:12","2017\/10\/24 09:18","2017\/10\/24 10:27","2017\/10\/24 11:34","2017\/10\/24 11:38","2017\/10\/24 12:00","2017\/10\/24 12:05","2017\/10\/24 13:28","2017\/10\/24 13:33","2017\/10\/24 13:35","2017\/10\/24 13:46","2017\/10\/24 13:56","2017\/10\/24 13:57","2017\/10\/25 01:16","2017\/10\/25 01:17","2017\/10\/25 01:20","2017\/10\/25 01:25","2017\/10\/25 01:28","2017\/10\/25 01:31","2017\/10\/25 01:35","2017\/10\/25 01:42","2017\/10\/25 01:44","2017\/10\/25 01:46","2017\/10\/25 01:47","2017\/10\/25 02:08","2017\/10\/25 02:20","2017\/10\/25 02:29","2017\/10\/25 05:06","2017\/10\/25 05:18","2017\/10\/25 05:19","2017\/10\/25 05:22","2017\/10\/25 05:23","2017\/10\/25 05:27","2017\/10\/25 06:22","2017\/10\/25 08:17","2017\/10\/25 08:30","2017\/10\/25 08:38","2017\/10\/25 09:00","2017\/10\/25 09:05","2017\/10\/25 09:09","2017\/10\/25 09:17","2017\/10\/25 09:24","2017\/10\/25 09:28","2017\/10\/25 10:00","2017\/10\/25 10:01","2017\/10\/25 10:06","2017\/10\/25 10:07","2017\/10\/25 10:24","2017\/10\/25 10:31","2017\/10\/25 10:33","2017\/10\/25 10:34","2017\/10\/25 10:36","2017\/10\/25 11:21","2017\/10\/25 11:25","2017\/10\/25 11:53","2017\/10\/25 12:06","2017\/10\/25 12:40","2017\/10\/25 12:41","2017\/10\/25 12:42","2017\/10\/25 12:43","2017\/10\/25 12:59","2017\/10\/25 13:26","2017\/10\/25 13:28","2017\/10\/25 13:40","2017\/10\/25 13:55","2017\/10\/25 13:59","2017\/10\/25 14:06","2017\/10\/25 14:11","2017\/10\/25 14:12","2017\/10\/25 14:15","2017\/10\/25 14:20","2017\/10\/25 14:25","2017\/10\/25 14:28","2017\/10\/25 14:41","2017\/10\/25 14:48","2017\/10\/25 14:49","2017\/10\/25 14:50","2017\/10\/25 14:54","2017\/10\/25 14:58","2017\/10\/25 15:04","2017\/10\/25 15:17","2017\/10\/25 15:18","2017\/10\/25 15:55","2017\/10\/25 15:57","2017\/10\/25 16:09","2017\/10\/25 16:12","2017\/10\/25 16:19","2017\/10\/25 16:33","2017\/10\/25 16:51","2017\/10\/25 16:59","2017\/10\/25 17:07","2017\/10\/25 17:13","2017\/10\/25 17:51","2017\/10\/25 18:07","2017\/10\/25 18:14","2017\/10\/25 20:50","2017\/10\/25 20:53","2017\/10\/25 21:05","2017\/10\/25 21:06","2017\/10\/25 21:07","2017\/10\/25 21:08","2017\/10\/25 21:09","2017\/10\/25 22:28","2017\/10\/25 22:50","2017\/10\/26 00:15","2017\/10\/26 00:51","2017\/10\/26 01:20","2017\/10\/26 01:52","2017\/10\/26 02:01","2017\/10\/26 06:05","2017\/10\/26 07:15","2017\/10\/26 07:20","2017\/10\/26 07:21","2017\/10\/26 07:22","2017\/10\/26 08:22","2017\/10\/26 08:43","2017\/10\/26 09:17","2017\/10\/26 09:32","2017\/10\/26 09:42","2017\/10\/26 11:50","2017\/10\/27 02:49","2017\/10\/27 07:12","2017\/10\/27 07:55","2017\/10\/27 08:07","2017\/10\/30 08:07","2017\/10\/30 08:10","2017\/10\/30 12:57","2017\/10\/30 13:17","2017\/10\/30 13:24","2017\/10\/30 16:29","2017\/10\/31 09:04","2017\/10\/31 11:25","2017\/10\/31 13:00","2017\/10\/31 13:04","2017\/11\/01 06:09","2017\/11\/01 06:10","2017\/11\/01 06:49","2017\/11\/01 08:25","2017\/11\/01 09:11","2017\/11\/01 09:21","2017\/11\/01 09:32","2017\/11\/03 09:59","2017\/11\/03 11:20","2017\/11\/03 13:05","2017\/11\/06 08:27","2017\/11\/06 08:54","2017\/11\/06 09:00","2017\/11\/06 09:16","2017\/11\/08 10:38","2017\/11\/08 12:16","2017\/11\/09 05:34","2017\/11\/09 08:58","2017\/11\/09 09:15","2017\/11\/10 07:44","2017\/11\/10 08:00","2017\/11\/10 08:04","2017\/11\/10 12:12","2017\/11\/10 12:13","2017\/11\/10 13:38","2017\/11\/13 08:59","2017\/11\/13 09:57","2017\/11\/13 11:47","2017\/11\/14 07:18","2017\/11\/14 07:34","2017\/11\/14 07:55","2017\/11\/15 07:38","2017\/11\/15 09:29","2017\/11\/15 09:38","2017\/11\/15 09:44","2017\/11\/15 10:05","2017\/11\/16 07:21","2017\/11\/16 07:35","2017\/11\/16 13:51","2017\/11\/16 14:41","2017\/11\/16 15:34","2017\/11\/17 01:30","2017\/11\/17 02:03","2017\/11\/17 02:32","2017\/11\/17 08:02","2017\/11\/17 08:48","2017\/11\/17 11:01","2017\/11\/17 11:09","2017\/11\/20 06:49","2017\/11\/20 07:14","2017\/11\/20 07:17","2017\/11\/21 07:37","2017\/11\/21 11:21","2017\/11\/21 14:24","2017\/11\/22 09:51","2017\/11\/22 12:57","2017\/11\/23 08:25","2017\/11\/23 09:23","2017\/11\/23 09:36","2017\/11\/24 08:17","2017\/11\/24 14:17","2017\/11\/27 08:28","2017\/11\/27 13:00","2017\/11\/27 14:44","2017\/11\/28 07:20","2017\/11\/28 08:46","2017\/11\/28 11:20","2017\/11\/28 12:50","2017\/11\/28 15:53","2017\/11\/29 07:12","2017\/11\/29 07:14","2017\/11\/29 07:34","2017\/11\/30 08:37","2017\/11\/30 12:06","2017\/11\/30 14:06","2017\/11\/30 14:51","2017\/12\/01 02:14","2017\/12\/01 07:52","2017\/12\/01 07:58","2017\/12\/01 08:35","2017\/12\/01 08:43","2017\/12\/01 09:25","2017\/12\/01 09:28","2017\/12\/01 11:45","2017\/12\/04 07:10","2017\/12\/04 07:12","2017\/12\/04 11:21","2017\/12\/05 08:00","2017\/12\/05 08:30","2017\/12\/07 08:53","2017\/12\/07 10:24","2017\/12\/07 10:59","2017\/12\/07 11:39","2017\/12\/07 11:57","2017\/12\/07 12:00","2017\/12\/08 04:50","2017\/12\/08 06:08","2017\/12\/11 08:21","2017\/12\/11 08:22","2017\/12\/11 10:26","2017\/12\/11 11:45","2017\/12\/11 14:40","2017\/12\/12 02:06","2017\/12\/12 09:30","2017\/12\/12 09:31","2017\/12\/12 09:38","2017\/12\/13 08:55","2017\/12\/13 10:12","2017\/12\/13 13:21","2017\/12\/13 13:25","2017\/12\/14 10:27","2017\/12\/14 10:31","2017\/12\/15 17:01","2017\/12\/15 17:05","2017\/12\/15 19:53","2017\/12\/15 21:00","2017\/12\/18 14:22","2017\/12\/20 16:03","2017\/12\/20 17:00","2017\/12\/20 20:01","2017\/12\/21 20:33","2017\/12\/27 16:39","2017\/12\/29 13:29","2017\/12\/29 23:57","2018\/01\/02 18:02","2018\/01\/05 10:14","2018\/01\/05 13:56","2018\/01\/08 11:01","2018\/01\/09 01:37","2018\/01\/09 01:47","2018\/01\/09 06:53","2018\/01\/11 07:38","2018\/01\/11 07:42","2018\/01\/11 07:43","2018\/01\/11 08:33","2018\/01\/11 19:54","2018\/01\/12 09:16","2018\/01\/12 09:16","2018\/01\/12 16:55","2018\/01\/17 08:20","2018\/01\/17 22:05","2018\/01\/18 11:23","2018\/01\/18 20:37","2018\/01\/18 22:21","2018\/01\/19 09:30","2018\/01\/19 09:39","2018\/01\/19 11:35","2018\/01\/19 12:43","2018\/01\/19 22:00","2018\/01\/22 08:37","2018\/01\/23 07:28","2018\/01\/23 08:38","2018\/01\/23 14:37","2018\/01\/24 08:43","2018\/01\/24 11:44","2018\/01\/24 19:18","2018\/01\/24 19:54","2018\/01\/25 07:59","2018\/01\/25 08:26","2018\/01\/25 09:02","2018\/01\/25 15:36","2018\/01\/25 16:21","2018\/01\/25 17:15","2018\/01\/25 17:51","2018\/01\/26 16:22","2018\/01\/30 12:18","2018\/01\/30 16:04","2018\/01\/30 16:16","2018\/01\/30 16:59","2018\/01\/30 17:48","2018\/01\/31 16:41","2018\/01\/31 16:52","2018\/01\/31 17:39","2018\/02\/01 03:17","2018\/02\/01 03:23","2018\/02\/01 08:16","2018\/02\/01 16:28","2018\/02\/01 21:27","2018\/02\/02 11:02","2018\/02\/05 08:45","2018\/02\/05 09:34","2018\/02\/06 04:56","2018\/02\/06 05:11","2018\/02\/06 05:39","2018\/02\/06 06:14","2018\/02\/07 07:19","2018\/02\/07 07:38","2018\/02\/09 05:40","2018\/02\/09 06:01","2018\/02\/09 06:39","2018\/02\/12 03:58","2018\/02\/14 02:57","2018\/02\/14 03:58","2018\/02\/23 08:06","2018\/02\/23 08:34","2018\/02\/26 07:36","2018\/02\/27 07:49","2018\/02\/27 08:13","2018\/02\/27 16:36","2018\/02\/28 08:56","2018\/02\/28 09:58","2018\/02\/28 11:47","2018\/02\/28 12:08","2018\/03\/01 02:11","2018\/03\/02 05:56","2018\/03\/02 06:38","2018\/03\/05 08:10","2018\/03\/06 11:13","2018\/03\/08 12:48","2018\/03\/08 14:38","2018\/03\/09 12:02","2018\/03\/09 13:32","2018\/03\/09 14:40","2018\/03\/09 14:52","2018\/03\/12 12:39","2018\/03\/14 08:56","2018\/03\/14 10:42","2018\/03\/16 07:37","2018\/03\/19 09:07","2018\/03\/19 09:38","2018\/03\/20 07:19","2018\/03\/20 09:11","2018\/03\/21 09:34","2018\/03\/21 11:47","2018\/03\/21 12:43","2018\/03\/22 08:04","2018\/03\/22 09:27","2018\/03\/22 09:56","2018\/03\/22 12:08","2018\/03\/23 08:01","2018\/03\/23 08:52","2018\/03\/23 10:32","2018\/03\/23 12:00","2018\/03\/23 12:19","2018\/03\/26 06:53","2018\/03\/27 07:24","2018\/03\/27 07:36","2018\/03\/27 07:59","2018\/03\/28 06:03","2018\/03\/28 06:44","2018\/03\/28 07:16","2018\/03\/29 07:04","2018\/03\/29 09:20","2018\/03\/29 10:46","2018\/03\/29 14:47","2018\/03\/30 06:17","2018\/04\/02 15:05","2018\/04\/02 15:08","2018\/04\/02 15:21","2018\/04\/04 07:10","2018\/04\/04 07:49","2018\/04\/04 08:03","2018\/04\/05 06:36","2018\/04\/05 08:53","2018\/04\/05 11:28","2018\/04\/05 15:23","2018\/04\/06 09:15","2018\/04\/06 13:34","2018\/04\/09 06:20","2018\/04\/10 07:58","2018\/04\/10 11:50","2018\/04\/10 15:25","2018\/04\/11 06:44","2018\/04\/11 09:01","2018\/04\/12 09:01","2018\/04\/13 06:25","2018\/04\/16 06:26","2018\/04\/16 08:06","2018\/04\/17 08:36","2018\/04\/18 07:02","2018\/04\/18 08:39","2018\/04\/19 08:33","2018\/04\/20 08:32","2018\/04\/20 09:09","2018\/04\/23 07:27","2018\/04\/23 08:42","2018\/04\/24 08:56","2018\/04\/24 12:36","2018\/04\/25 16:59","2018\/04\/26 14:21","2018\/04\/26 15:37","2018\/04\/27 08:32","2018\/04\/30 06:47","2018\/04\/30 08:59","2018\/05\/01 03:21","2018\/05\/02 06:14","2018\/05\/02 08:30","2018\/05\/03 09:12","2018\/05\/03 10:04","2018\/05\/04 08:58","2018\/05\/08 09:48","2018\/05\/08 13:17","2018\/05\/09 08:58","2018\/05\/09 11:02","2018\/05\/09 11:29","2018\/05\/10 07:51","2018\/05\/10 08:18","2018\/05\/10 08:36","2018\/05\/11 07:16","2018\/05\/14 07:14","2018\/05\/14 07:47","2018\/05\/16 07:04","2018\/05\/16 12:17","2018\/05\/16 13:23","2018\/05\/17 06:49","2018\/05\/17 07:15","2018\/05\/17 07:59","2018\/05\/18 07:01","2018\/05\/18 07:03","2018\/05\/18 09:42","2018\/05\/21 10:04","2018\/05\/21 12:00","2018\/05\/22 07:28","2018\/05\/22 07:41","2018\/05\/22 08:30","2018\/05\/22 09:28","2018\/05\/23 07:04","2018\/05\/24 06:20","2018\/05\/24 06:31","2018\/05\/24 06:45","2018\/05\/25 07:03","2018\/05\/25 07:13","2018\/05\/28 06:01","2018\/05\/29 06:07","2018\/05\/29 06:20","2018\/05\/30 05:53","2018\/05\/30 06:10","2018\/05\/30 06:58","2018\/05\/31 05:42","2018\/05\/31 06:34","2018\/06\/04 07:03","2018\/06\/05 07:51","2018\/06\/05 11:54","2018\/06\/08 06:14","2018\/06\/13 08:08","2018\/06\/13 09:36","2018\/06\/13 15:57","2018\/06\/14 08:36","2018\/06\/15 07:12","2018\/06\/18 12:44","2018\/06\/18 18:11","2018\/06\/19 07:05","2018\/06\/19 07:26","2018\/06\/20 06:39","2018\/06\/22 05:36","2018\/06\/22 08:45","2018\/06\/25 13:45","2018\/06\/25 14:48","2018\/06\/26 08:04","2018\/06\/26 09:11","2018\/06\/27 07:09","2018\/06\/27 07:47","2018\/06\/28 05:38","2018\/07\/02 07:03","2018\/07\/02 07:43","2018\/07\/02 08:46","2018\/07\/03 06:10","2018\/07\/04 08:09","2018\/07\/05 05:49","2018\/07\/05 07:41","2018\/07\/05 07:43","2018\/07\/05 07:45","2018\/07\/05 07:46","2018\/07\/05 07:47","2018\/07\/05 07:48","2018\/07\/05 07:49","2018\/07\/06 12:36","2018\/07\/09 07:27","2018\/07\/09 08:22","2018\/07\/09 10:25","2018\/07\/10 07:04","2018\/07\/10 07:58","2018\/07\/11 06:27","2018\/07\/11 07:04","2018\/07\/11 12:40","2018\/07\/16 11:57","2018\/07\/17 08:32","2018\/07\/17 09:27","2018\/07\/17 11:18","2018\/07\/18 08:26","2018\/07\/18 08:31","2018\/07\/18 08:35","2018\/07\/19 08:36","2018\/07\/20 07:18","2018\/07\/23 14:52","2018\/07\/24 07:41","2018\/07\/26 14:27","2018\/07\/26 15:51","2018\/07\/27 06:37","2018\/07\/27 07:19","2018\/07\/27 12:59","2018\/07\/31 06:41","2018\/07\/31 08:07","2018\/07\/31 10:41","2018\/08\/02 07:21","2018\/08\/07 18:51","2018\/08\/08 07:29","2018\/08\/08 08:18","2018\/08\/09 05:07","2018\/08\/14 05:49","2018\/08\/14 06:54","2018\/08\/15 07:19","2018\/08\/17 09:56","2018\/08\/20 07:38","2018\/08\/20 11:08","2018\/08\/21 07:58","2018\/08\/21 14:00","2018\/08\/22 08:08","2018\/08\/24 10:24","2018\/08\/28 07:13","2018\/08\/28 07:53"],[10000,10081,10174.64,10253.1,10163.94,10150.56,10177.3,10216,10234.2,10263.38,10294.38,10274.5,10304.5,10335.22,10389.82,10384.84,10392.18,10434.64,10438.18,10441.72,10442.34,10446.06,10449.86,10454.28,10458.18,10462.16,10466.78,10469.88,10466.26,10469.88,10473.42,10469.8,10466.9,10470.66,10474.28,10471.38,10468.4,10465.36,10461.82,10299.66,10463.3,10447.9,10492.88,10584.34,10569.24,10599.74,10584.96,10613.94,10590.64,10588.66,10606.22,10603.56,10562.52,10558.28,10580,10599.64,10587.86,10560.62,10590.34,10592.64,10590,10590.52,10600.06,10595.82,10586.64,10577.64,10573.76,10576.24,10595.86,10602.4,10606.28,10597.44,10623.74,10520.72,10747.1,10652.48,10745.06,10658.54,11065.04,10942.64,10940.7,10935.58,10931.34,11072.6,11063.6,11039.78,11017.54,10978.74,11020.54,10993.18,10960.7,10951.7,10973.94,10964.38,10985.76,10996.02,10995.32,10997.46,10996.58,10995.66,10996.68,10995.8,10995.78,10995.7,10995.56,10994.66,10994.18,10994.86,10995.5,10996.26,10995.38,10997.5,11003.06,11005.52,11007.9,11007.02,11006.14,10926.1,10925.96,10925.06,10924.9,10924.02,10923.08,10923.36,10923.52,10922.6,10922.46,10903.42,10903.2,10903.9,10905.32,10887.32,10880.98,10880.6,10879.86,10881.1,10880.46,10882.6,10883.1,10883.4,10882.52,10881.62,10880.74,10882.62,10882.54,10882.46,10882.84,10882.7,10882.88,10882.94,10882.52,10881.4,10882.18,10881.38,10881.88,10882.36,10883.42,10882.48,10881.58,10880.7,10879.82,10879.84,10868.22,10874.2,10853.44,10911.46,10893.52,10874.18,10916.74,10959.26,11003.48,11000.52,10994.38,10987.98,11000.28,11002.38,10996.1,11004.78,11000.56,10982.62,10981.92,10964.36,10982.28,10964.7,10946.78,10943.96,10941.5,10947.12,10982.26,11001.58,11005.8,10988.24,11002.3,11000.9,10989.32,10996.7,10979.12,10961.2,10942.58,10916.24,11107.58,11262.14,11244.62,11299.66,11341.72,11385.16,11455.2,11436.3,11397.78,11445.42,11427.54,11410.04,11392.18,11472.78,11534.8,11584.56,11612.76,11603.3,11626.44,11616.08,11621.16,11620.28,11617.66,11612.92,11612.04,11618.5,11617.62,11616.72,11615.84,11614.98,11614.08,11613.2,11612.22,11611.24,11615.68,11614.78,11616.92,11616.04,11615.14,11614.18,11613.3,11612.4,11611.52,11613.62,11615.78,11614.32,11613.44,11612.54,11611.6,11610.72,11612.84,11615.58,11614.52,11613.6,11612.58,11615.5,11614.58,11616.9,11613.82,11612.94,11612.04,11611.1,11609.34,11607.84,11605.82,11603.04,11602.12,11601.2,11603.98,11602.72,11604.26,11606.54,11629.8,11606.44,11661.34,11661.7,11662.08,11662.52,11622.96,11770.22,11889.74,11847,11967.38,12086.94,12206.02,12192.02,12275.56,12322.4,12190.5,12067.54,11946.08,11986.62,11751.36,11709.06,11831.8,11790.42,11987.56,12272.26,12105.98,11953.76,12101.36,12140,12089.8,12259.7,12440.22,12640.02,12477.08,12639.14,12489.54,12434.58,12586.72,12776.12,12933.88,13049.1,13219.3,13380.46,13116.66,13170.56,13003.64,13156.84,13384.92,13184.48,13357.84,13152.78,13001.98,12839.1,12998.58,13148.98,13266.28,13213.82,13163.26,13112.68,13494.12,13349.46,13130.1,13184.14,12998.32,12798.46,12562.44,12775.26,12938.4,13134.8,13079.34,13026.08,13330.96,13497.26,13280.98,13496.22,13621.5,13407.12,13297.28,13537.7,13752.88,14021.54,13909.36,14126.1,14104.54,13995.78,14163.8,14381.82,14600.16,14334.52,14443.44,14205.04,14097.24,14313.9,14601.9,14825.88,14997.06,14766.7,14978.16,15306.1,15072.96,14878.98,13378.98,13540.42,13379.8,13462.24,13261.28,13024.16,12820.78,12981.72,12813.36,12975.46,13415.78,13258.72,13575.98,13419,13169.04,13087.82,13246.3,13402.38,13636.52,13794.92,13952.48,13680.06,13571.4,13493.02,13587.7,13509.34,13665.52,13871.1,13791.22,13999.94,14183.98,14027.24,13870.42,13691.78,13847.84,14010.94,13932.5,14119.18,14279.96,14365.46,14542.18,14629.3,14548.4,14469.84,14634.1,14796.38,14957.48,15114.68,15290.72,15348.16,15490.5,15563.36,15420.98,15166.64,15025.26,14915.06,14775.34,14655.3,14764.16,14908.18,15056.48,15204.78,15350.8,15505.36,15650.52,15795.8,15935.32,15773.32,15905.66,15747.96,15586.76,15511.58,15694.62,15840.42,15985.2,16209.14,16028.12,15877.44,15717.38,15791.92,15635.56,15488.06,15244,15318.02,15391.36,15464.72,15318.06,15169.16,15349.7,15201.78,15079.62,14967.84,14847.14,14720.56,14645.52,14826.42,14957.4,13457.4,14957.4,15109.42,15218.98,15329.92,15447.36,15558.82,15349.04,15274.64,15460.02,15612.84,15730.46,15885.1,16068.52,15994.36,16105.18,16250.5,16405.04,16289.46,16096.34,16218.28,16330.54,16447.8,16560.04,16483.76,16596.22,16520.1,16635.16,16791.98,16906.26,15706.26,15830.16,15954.86,16083.8,16225.54,16085.38,15971.66,16104.24,16280.7,16201.32,16353.2,16514.54,16667.6,16780.96,16957.98,16805.46,16670.36,16423.1,16653.7,16898.38,16689.06,16630.34,16746.2,16640.16,16797,16917.38,16840.42,16969.28,16891.52,16809.3,17003.28,17177.68,17297.36,17414.1,17294.28,17179.2,17006.56,17161.82,17086.84,17010.36,17145.42,17264.96,17378.68,17533.14,17653,17698.98,17529.3,17330.6,17198.72,17110.54,17029.18,17141.28,17060.84,17174.82,17307.76,17482.66,17630.16,17849.88,17701.52,17819.62,17935.5,17707.82,17820.14,17995.44,18116.3,18230.72,18342.54,17769.06,17979.2,17895.18,17817.84,17732.58,17857.1,17987.18,18097.32,18018.22,17935.52,18050.38,18455.48,18575.6,18686.82,17586.82,17697.54,17850.52,18138.02,18008.04,17896.54,18007.4,18118.02,17980.28,18091.18,18204.26,18028.2,17839.64,17694.04,17746.72,17596.9,17482.16,17591.76,17516.22,17625.24,17552.08,17706.24,17832.18,17759.28,17868.28,18018.22,17945.62,18053.5,18221.94,18148.52,18273.96,18384.22,18611.2,18500.02,18388.98,18220.38,18362.26,18278.88,18391.3,18281.2,18170.34,18093.72,18262.84,18188.62,18318.82,18430.64,18580.94,18507.38,18719.52,18880.14,19022.58,18949.56,19058.26,19268.44,19157.94,19042.84,18929.88,19040.76,19150.08,19272.1,19162.96,19301.68,19227.96,19154.26,19079.82,19004.68,19113.98,19225.54,19435.84,19323.8,19215.34,19007.38,19115.54,19268.32,19399.94,19451.98,19505.46,19519.94,19527.16,19543.78,19574.86,19601.6,19711.68,19637.1,19751.6,19868.92,19753.7,19585.9,19477.88,19276.82,19384.66,19309.88,19186.72,19297.06,19486.1,19604.3,19900.8,19759.26,19984.46,20104.04,20029.38,20192.66,20083.24,19928.46,19841.28,19768.52,19878.1,20059.48,20199.5,20272.68,20164.48,20272.9,20429.48,20550.6,20658.76,20585.88,20804.3,20975.34,21119.32,21041.24,21200.36,21127.76,21261.04,21151.64,21018.82,21129.7,21241.96]]`);

    var data2 = [['197.29', '-54.1', '54.21', '138.85', '54.08', '72.77', '85.52', '71.99', '40.52', '30.34', '-54.7', '-66.41', '111.57'], ['2018-07-31', '2018-08-02', '2018-08-07', '2018-08-08', '2018-08-09', '2018-08-14', '2018-08-15', '2018-08-17', '2018-08-20', '2018-08-21', '2018-08-22', '2018-08-24', '2018-08-28',]];

    var data3 = [['1', '0', '0', '2', '0', '1', '0', '1', '1', '1', '0', '1', '1'], ['2', '1', '1', '0', '1', '1', '1', '0', '1', '1', '1', '0', '1',], ['2018-07-31', '2018-08-02', '2018-08-07', '2018-08-08', '2018-08-09', '2018-08-14', '2018-08-15', '2018-08-17', '2018-08-20', '2018-08-21', '2018-08-22', '2018-08-24', '2018-08-28']]

    var data4 = [[3, 2, 502, 196], ['eurgbp.', 'EURUSD.', 'GBPJPY.', 'GBPJPY.ecn']]

    var buffer = xlsx.build([{ name: "data1", data: data }, { name: 'data2', data: jingzhi_data },
    { name: 'data3', data: data2 }, { name: 'data4', data: data3 }, { name: 'data5', data: data4 }]); // Returns a buffer

    // let users = doc.filter((child) => { return child.team && child.team.length > 0 }).map((child, index) => {
    //     return {
    //         name: child.name,
    //         email: child.email,
    //         team: child.team
    //     }
    // });

    fs.writeFile(`${__dirname}/../public/pp.xlsx`, buffer, {}, () => {
        // res.redirect('/score.xlsx')
        // db.close();
        res.send('failed')
    });
})
router.get('/charts', function (req, res) {
    if (req.query.id) {
        const workSheetsFromFile = xlsx.parse(`${__dirname}/../public/${req.query.id}.xlsx`);
        let datas = [];
        if (workSheetsFromFile && workSheetsFromFile.length > 0) {
            let data1 = workSheetsFromFile[0];
            let data2 = workSheetsFromFile.length >= 2 ? workSheetsFromFile[1] : [];
            let data3 = workSheetsFromFile.length >= 3 ? workSheetsFromFile[2] : [];
            let data4 = workSheetsFromFile.length >= 4 ? workSheetsFromFile[3] : [];
            let data5 = workSheetsFromFile.length >= 5 ? workSheetsFromFile[4] : [];
            res.render('charts', { dom: viewHandler.buildCharts(data1, data2, data3, data4, data5) })
        }
        res.send('failed')
    }
    else {
        res.send('failed')
    }
})

router.get('/clearCookie', function (req, res) {
    res.cookie('hasAvator', null, { maxAge: 1000 })
    res.cookie('user', null, { maxAge: 1000 })
    res.send('ok')
})

module.exports = router;